{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\aas_8\\\\Desktop\\\\restaurant stripe\\\\components\\\\context.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n      query {\\n        me {\\n          id\\n          email\\n          username\\n        }\\n      }\\n    \"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/* /context/AppContext.js */\nimport React from \"react\"; // create auth context with default value\n// set backup default for isAuthenticated if none is provided in Provider\n// const AppContext = React.createContext(\n//     {isAuthenticated:true, \n//         cart: {items:[], \n//         total:0},\n//         addItem:()=>{},\n//         removeItem:()=>{},\n//         user:false, \n//         setUser:()=>{}\n//     });\n\nimport { useState, createContext, useContext, useEffect } from \"react\";\nimport Cookie from \"js-cookie\";\nimport { gql } from \"@apollo/client\";\nimport { client } from \"@/pages/_app.js\";\nvar AppContext = /*#__PURE__*/createContext();\nexport var AppProvider = function AppProvider(_ref) {\n  _s();\n\n  var children = _ref.children;\n  var cartCookie = Cookie.get(\"cart\") !== \"undefined\" ? Cookie.get(\"cart\") : null;\n\n  var _useState = useState(null),\n      user = _useState[0],\n      setUser = _useState[1];\n\n  var _useState2 = useState(true),\n      showCart = _useState2[0],\n      setShowCart = _useState2[1];\n\n  var _useState3 = useState(cartCookie ? JSON.parse(cartCookie) : {\n    items: [],\n    total: 0\n  }),\n      cart = _useState3[0],\n      setCart = _useState3[1];\n\n  useEffect(function () {\n    var fetchData = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var userData;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return getUser();\n\n              case 2:\n                userData = _context.sent;\n                setUser(userData);\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function fetchData() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    fetchData();\n  }, []);\n  useEffect(function () {\n    Cookie.set(\"cart\", JSON.stringify(cart));\n  }, [cart]);\n\n  var addItem = function addItem(item) {\n    var newItem = cart.items.find(function (i) {\n      return i.id === item.id;\n    });\n\n    if (!newItem) {\n      var _newItem = _objectSpread({\n        quantity: 1\n      }, item);\n\n      setCart(function (prevCart) {\n        return {\n          items: [].concat(_toConsumableArray(prevCart.items), [_newItem]),\n          total: prevCart.total + item.attributes.priceInCents\n        };\n      });\n    } else {\n      setCart(function (prevCart) {\n        return {\n          items: prevCart.items.map(function (i) {\n            return i.id === newItem.id ? _objectSpread(_objectSpread({}, i), {}, {\n              quantity: i.quantity + 1\n            }) : i;\n          }),\n          total: prevCart.total + item.attributes.priceInCents\n        };\n      });\n    }\n  };\n\n  var removeItem = function removeItem(item) {\n    var newItem = cart.items.find(function (i) {\n      return i.id === item.id;\n    });\n\n    if (newItem.quantity > 1) {\n      setCart(function (prevCart) {\n        return {\n          items: prevCart.items.map(function (i) {\n            return i.id === newItem.id ? _objectSpread(_objectSpread({}, i), {}, {\n              quantity: i.quantity - 1\n            }) : i;\n          }),\n          total: prevCart.total - item.attributes.priceInCents\n        };\n      });\n    } else {\n      setCart(function (prevCart) {\n        return {\n          items: prevCart.items.filter(function (i) {\n            return i.id !== item.id;\n          }),\n          total: prevCart.total - item.attributes.priceInCents\n        };\n      });\n    }\n  };\n\n  var resetCart = function resetCart() {\n    setCart({\n      items: [],\n      total: 0\n    });\n  };\n\n  return __jsx(AppContext.Provider, {\n    value: {\n      user: user,\n      setUser: setUser,\n      cart: cart,\n      addItem: addItem,\n      removeItem: removeItem,\n      resetCart: resetCart,\n      showCart: showCart,\n      setShowCart: setShowCart\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 5\n    }\n  }, children);\n};\n\n_s(AppProvider, \"oYYIrKRoVW12bpey1v8RcVMucUU=\");\n\n_c = AppProvider;\n\nvar getUser = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    var token, _yield$client$query, data;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            token = Cookie.get(\"token\");\n\n            if (token) {\n              _context2.next = 3;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", null);\n\n          case 3:\n            _context2.next = 5;\n            return client.query({\n              query: gql(_templateObject()),\n              context: {\n                headers: {\n                  Authorization: \"Bearer \".concat(token)\n                }\n              }\n            });\n\n          case 5:\n            _yield$client$query = _context2.sent;\n            data = _yield$client$query.data;\n            return _context2.abrupt(\"return\", data.me);\n\n          case 8:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function getUser() {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nexport var useAppContext = function useAppContext() {\n  _s2();\n\n  var context = useContext(AppContext);\n  if (context === undefined) throw new Error(\"useAppContext must be used within an AppProvider\");\n  return context;\n};\n\n_s2(useAppContext, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n\nexport default AppContext;\n\nvar _c;\n\n$RefreshReg$(_c, \"AppProvider\");","map":{"version":3,"sources":["C:/Users/aas_8/Desktop/restaurant stripe/components/context.js"],"names":["React","useState","createContext","useContext","useEffect","Cookie","gql","client","AppContext","AppProvider","children","cartCookie","get","user","setUser","showCart","setShowCart","JSON","parse","items","total","cart","setCart","fetchData","getUser","userData","set","stringify","addItem","item","newItem","find","i","id","quantity","prevCart","attributes","priceInCents","map","removeItem","filter","resetCart","token","query","context","headers","Authorization","data","me","useAppContext","undefined","Error"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA,OAAOA,KAAP,MAAkB,OAAlB,C,CACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASC,QAAT,EAAmBC,aAAnB,EAAkCC,UAAlC,EAA8CC,SAA9C,QAA+D,OAA/D;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,SAASC,GAAT,QAAoB,gBAApB;AACA,SAASC,MAAT,QAAuB,iBAAvB;AAEA,IAAMC,UAAU,gBAAGN,aAAa,EAAhC;AAEA,OAAO,IAAMO,WAAW,GAAG,SAAdA,WAAc,OAAkB;AAAA;;AAAA,MAAfC,QAAe,QAAfA,QAAe;AAC3C,MAAMC,UAAU,GACdN,MAAM,CAACO,GAAP,CAAW,MAAX,MAAuB,WAAvB,GAAqCP,MAAM,CAACO,GAAP,CAAW,MAAX,CAArC,GAA0D,IAD5D;;AAD2C,kBAInBX,QAAQ,CAAC,IAAD,CAJW;AAAA,MAIpCY,IAJoC;AAAA,MAI9BC,OAJ8B;;AAAA,mBAKXb,QAAQ,CAAC,IAAD,CALG;AAAA,MAKpCc,QALoC;AAAA,MAK1BC,WAL0B;;AAAA,mBAMnBf,QAAQ,CAC9BU,UAAU,GAAGM,IAAI,CAACC,KAAL,CAAWP,UAAX,CAAH,GAA4B;AAAEQ,IAAAA,KAAK,EAAE,EAAT;AAAaC,IAAAA,KAAK,EAAE;AAApB,GADR,CANW;AAAA,MAMpCC,IANoC;AAAA,MAM9BC,OAN8B;;AAU3ClB,EAAAA,SAAS,CAAC,YAAM;AACd,QAAMmB,SAAS;AAAA,2EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACOC,OAAO,EADd;;AAAA;AACVC,gBAAAA,QADU;AAEhBX,gBAAAA,OAAO,CAACW,QAAD,CAAP;;AAFgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAATF,SAAS;AAAA;AAAA;AAAA,OAAf;;AAIAA,IAAAA,SAAS;AACV,GANQ,EAMN,EANM,CAAT;AAQAnB,EAAAA,SAAS,CAAC,YAAM;AACdC,IAAAA,MAAM,CAACqB,GAAP,CAAW,MAAX,EAAmBT,IAAI,CAACU,SAAL,CAAeN,IAAf,CAAnB;AACD,GAFQ,EAEN,CAACA,IAAD,CAFM,CAAT;;AAIA,MAAMO,OAAO,GAAG,SAAVA,OAAU,CAACC,IAAD,EAAU;AACxB,QAAIC,OAAO,GAAGT,IAAI,CAACF,KAAL,CAAWY,IAAX,CAAgB,UAACC,CAAD;AAAA,aAAOA,CAAC,CAACC,EAAF,KAASJ,IAAI,CAACI,EAArB;AAAA,KAAhB,CAAd;;AACA,QAAI,CAACH,OAAL,EAAc;AACZ,UAAMA,QAAO;AACXI,QAAAA,QAAQ,EAAE;AADC,SAERL,IAFQ,CAAb;;AAIAP,MAAAA,OAAO,CAAC,UAACa,QAAD;AAAA,eAAe;AACrBhB,UAAAA,KAAK,+BAAMgB,QAAQ,CAAChB,KAAf,IAAsBW,QAAtB,EADgB;AAErBV,UAAAA,KAAK,EAAEe,QAAQ,CAACf,KAAT,GAAiBS,IAAI,CAACO,UAAL,CAAgBC;AAFnB,SAAf;AAAA,OAAD,CAAP;AAID,KATD,MASO;AACLf,MAAAA,OAAO,CAAC,UAACa,QAAD;AAAA,eAAe;AACrBhB,UAAAA,KAAK,EAAEgB,QAAQ,CAAChB,KAAT,CAAemB,GAAf,CAAmB,UAACN,CAAD;AAAA,mBACxBA,CAAC,CAACC,EAAF,KAASH,OAAO,CAACG,EAAjB,mCAA2BD,CAA3B;AAA8BE,cAAAA,QAAQ,EAAEF,CAAC,CAACE,QAAF,GAAa;AAArD,iBAA2DF,CADnC;AAAA,WAAnB,CADc;AAIrBZ,UAAAA,KAAK,EAAEe,QAAQ,CAACf,KAAT,GAAiBS,IAAI,CAACO,UAAL,CAAgBC;AAJnB,SAAf;AAAA,OAAD,CAAP;AAMD;AACF,GAnBD;;AAqBA,MAAME,UAAU,GAAG,SAAbA,UAAa,CAACV,IAAD,EAAU;AAC3B,QAAIC,OAAO,GAAGT,IAAI,CAACF,KAAL,CAAWY,IAAX,CAAgB,UAACC,CAAD;AAAA,aAAOA,CAAC,CAACC,EAAF,KAASJ,IAAI,CAACI,EAArB;AAAA,KAAhB,CAAd;;AACA,QAAIH,OAAO,CAACI,QAAR,GAAmB,CAAvB,EAA0B;AACxBZ,MAAAA,OAAO,CAAC,UAACa,QAAD;AAAA,eAAe;AACrBhB,UAAAA,KAAK,EAAEgB,QAAQ,CAAChB,KAAT,CAAemB,GAAf,CAAmB,UAACN,CAAD;AAAA,mBACxBA,CAAC,CAACC,EAAF,KAASH,OAAO,CAACG,EAAjB,mCAA2BD,CAA3B;AAA8BE,cAAAA,QAAQ,EAAEF,CAAC,CAACE,QAAF,GAAa;AAArD,iBAA2DF,CADnC;AAAA,WAAnB,CADc;AAIrBZ,UAAAA,KAAK,EAAEe,QAAQ,CAACf,KAAT,GAAiBS,IAAI,CAACO,UAAL,CAAgBC;AAJnB,SAAf;AAAA,OAAD,CAAP;AAMD,KAPD,MAOO;AACLf,MAAAA,OAAO,CAAC,UAACa,QAAD;AAAA,eAAe;AACrBhB,UAAAA,KAAK,EAAEgB,QAAQ,CAAChB,KAAT,CAAeqB,MAAf,CAAsB,UAACR,CAAD;AAAA,mBAAOA,CAAC,CAACC,EAAF,KAASJ,IAAI,CAACI,EAArB;AAAA,WAAtB,CADc;AAErBb,UAAAA,KAAK,EAAEe,QAAQ,CAACf,KAAT,GAAiBS,IAAI,CAACO,UAAL,CAAgBC;AAFnB,SAAf;AAAA,OAAD,CAAP;AAID;AACF,GAfD;;AAiBA,MAAMI,SAAS,GAAG,SAAZA,SAAY,GAAM;AACtBnB,IAAAA,OAAO,CAAC;AAAEH,MAAAA,KAAK,EAAE,EAAT;AAAaC,MAAAA,KAAK,EAAE;AAApB,KAAD,CAAP;AACD,GAFD;;AAIA,SACE,MAAC,UAAD,CAAY,QAAZ;AACE,IAAA,KAAK,EAAE;AACLP,MAAAA,IAAI,EAAJA,IADK;AAELC,MAAAA,OAAO,EAAPA,OAFK;AAGLO,MAAAA,IAAI,EAAJA,IAHK;AAILO,MAAAA,OAAO,EAAPA,OAJK;AAKLW,MAAAA,UAAU,EAAVA,UALK;AAMLE,MAAAA,SAAS,EAATA,SANK;AAOL1B,MAAAA,QAAQ,EAARA,QAPK;AAQLC,MAAAA,WAAW,EAAXA;AARK,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAYGN,QAZH,CADF;AAgBD,CAhFM;;GAAMD,W;;KAAAA,W;;AAkFb,IAAMe,OAAO;AAAA,uEAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AACRkB,YAAAA,KADQ,GACArC,MAAM,CAACO,GAAP,CAAW,OAAX,CADA;;AAAA,gBAET8B,KAFS;AAAA;AAAA;AAAA;;AAAA,8CAEK,IAFL;;AAAA;AAAA;AAAA,mBAGSnC,MAAM,CAACoC,KAAP,CAAa;AAClCA,cAAAA,KAAK,EAAErC,GAAF,mBAD6B;AAUlCsC,cAAAA,OAAO,EAAE;AACPC,gBAAAA,OAAO,EAAE;AACPC,kBAAAA,aAAa,mBAAYJ,KAAZ;AADN;AADF;AAVyB,aAAb,CAHT;;AAAA;AAAA;AAGNK,YAAAA,IAHM,uBAGNA,IAHM;AAAA,8CAmBPA,IAAI,CAACC,EAnBE;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAPxB,OAAO;AAAA;AAAA;AAAA,GAAb;;AAsBA,OAAO,IAAMyB,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AAAA;;AACjC,MAAML,OAAO,GAAGzC,UAAU,CAACK,UAAD,CAA1B;AACA,MAAIoC,OAAO,KAAKM,SAAhB,EACE,MAAM,IAAIC,KAAJ,CAAU,kDAAV,CAAN;AACF,SAAOP,OAAP;AACD,CALM;;IAAMK,a;;AAOb,eAAezC,UAAf","sourcesContent":["/* /context/AppContext.js */\n\nimport React from \"react\";\n// create auth context with default value\n\n// set backup default for isAuthenticated if none is provided in Provider\n// const AppContext = React.createContext(\n//     {isAuthenticated:true, \n//         cart: {items:[], \n//         total:0},\n//         addItem:()=>{},\n//         removeItem:()=>{},\n//         user:false, \n//         setUser:()=>{}\n//     });\n\n\nimport { useState, createContext, useContext, useEffect } from \"react\";\nimport Cookie from \"js-cookie\";\nimport { gql } from \"@apollo/client\";\nimport { client } from \"@/pages/_app.js\";\n\nconst AppContext = createContext();\n\nexport const AppProvider = ({ children }) => {\n  const cartCookie =\n    Cookie.get(\"cart\") !== \"undefined\" ? Cookie.get(\"cart\") : null;\n\n  const [user, setUser] = useState(null);\n  const [showCart, setShowCart] = useState(true);\n  const [cart, setCart] = useState(\n    cartCookie ? JSON.parse(cartCookie) : { items: [], total: 0 }\n  );\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const userData = await getUser();\n      setUser(userData);\n    };\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    Cookie.set(\"cart\", JSON.stringify(cart));\n  }, [cart]);\n\n  const addItem = (item) => {\n    let newItem = cart.items.find((i) => i.id === item.id);\n    if (!newItem) {\n      const newItem = {\n        quantity: 1,\n        ...item,\n      };\n      setCart((prevCart) => ({\n        items: [...prevCart.items, newItem],\n        total: prevCart.total + item.attributes.priceInCents,\n      }));\n    } else {\n      setCart((prevCart) => ({\n        items: prevCart.items.map((i) =>\n          i.id === newItem.id ? { ...i, quantity: i.quantity + 1 } : i\n        ),\n        total: prevCart.total + item.attributes.priceInCents,\n      }));\n    }\n  };\n\n  const removeItem = (item) => {\n    let newItem = cart.items.find((i) => i.id === item.id);\n    if (newItem.quantity > 1) {\n      setCart((prevCart) => ({\n        items: prevCart.items.map((i) =>\n          i.id === newItem.id ? { ...i, quantity: i.quantity - 1 } : i\n        ),\n        total: prevCart.total - item.attributes.priceInCents,\n      }));\n    } else {\n      setCart((prevCart) => ({\n        items: prevCart.items.filter((i) => i.id !== item.id),\n        total: prevCart.total - item.attributes.priceInCents,\n      }));\n    }\n  };\n\n  const resetCart = () => {\n    setCart({ items: [], total: 0 });\n  };\n\n  return (\n    <AppContext.Provider\n      value={{\n        user,\n        setUser,\n        cart,\n        addItem,\n        removeItem,\n        resetCart,\n        showCart,\n        setShowCart,\n      }}\n    >\n      {children}\n    </AppContext.Provider>\n  );\n};\n\nconst getUser = async () => {\n  const token = Cookie.get(\"token\");\n  if (!token) return null;\n  const { data } = await client.query({\n    query: gql`\n      query {\n        me {\n          id\n          email\n          username\n        }\n      }\n    `,\n    context: {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    },\n  });\n  return data.me;\n};\n\nexport const useAppContext = () => {\n  const context = useContext(AppContext);\n  if (context === undefined)\n    throw new Error(\"useAppContext must be used within an AppProvider\");\n  return context;\n};\n\nexport default AppContext;"]},"metadata":{},"sourceType":"module"}